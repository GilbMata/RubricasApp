import{aJ as Fe,c as ce,aK as ye,a as F,b as c,aL as Se,g as ee,r as k,ae as ve,X as fe,a9 as xe,u as qe,d as ke,bi as ze,a3 as Ue,bl as we,w as Ce,o as Be,bm as Pe,aZ as Ee,aX as Ne,aj as ne,Q as Re,P as Y,ap as je,z as Ve,E as Ae,G as Le,H as Oe,I as Q,S as H,J as S,aP as G,aC as D,aO as se}from"./index.302b6eaf.js";import{Q as Qe}from"./QForm.ac6d8203.js";import{Q as Ie}from"./QImg.b372572c.js";import{b as $e,h as ie}from"./format.2bc25e5f.js";import{Q as De}from"./QPage.9da0b17f.js";import{U as Te}from"./userService.3498458a.js";import"./authHeader.38407fc4.js";const Me={...Fe,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:l=>l>=0&&l<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},Z=50,me=2*Z,pe=me*Math.PI,We=Math.round(pe*1e3)/1e3;var Xe=ce({name:"QCircularProgress",props:{...Me,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(l,{slots:d}){const{proxy:{$q:a}}=ee(),r=ye(l),i=F(()=>{const u=(a.lang.rtl===!0?-1:1)*l.angle;return{transform:l.reverse!==(a.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-u}deg)`:`rotate3d(0, 0, 1, ${u-90}deg)`}}),_=F(()=>l.instantFeedback!==!0&&l.indeterminate!==!0?{transition:`stroke-dashoffset ${l.animationSpeed}ms ease 0s, stroke ${l.animationSpeed}ms ease`}:""),h=F(()=>me/(1-l.thickness/2)),N=F(()=>`${h.value/2} ${h.value/2} ${h.value} ${h.value}`),B=F(()=>$e(l.value,l.min,l.max)),z=F(()=>pe*(1-(B.value-l.min)/(l.max-l.min))),C=F(()=>l.thickness/2*h.value);function p({thickness:u,offset:e,color:n,cls:y,rounded:P}){return c("circle",{class:"q-circular-progress__"+y+(n!==void 0?` text-${n}`:""),style:_.value,fill:"transparent",stroke:"currentColor","stroke-width":u,"stroke-dasharray":We,"stroke-dashoffset":e,"stroke-linecap":P,cx:h.value,cy:h.value,r:Z})}return()=>{const u=[];l.centerColor!==void 0&&l.centerColor!=="transparent"&&u.push(c("circle",{class:`q-circular-progress__center text-${l.centerColor}`,fill:"currentColor",r:Z-C.value/2,cx:h.value,cy:h.value})),l.trackColor!==void 0&&l.trackColor!=="transparent"&&u.push(p({cls:"track",thickness:C.value,offset:0,color:l.trackColor})),u.push(p({cls:"circle",thickness:C.value,offset:z.value,color:l.color,rounded:l.rounded===!0?"round":void 0}));const e=[c("svg",{class:"q-circular-progress__svg",style:i.value,viewBox:N.value,"aria-hidden":"true"},u)];return l.showValue===!0&&e.push(c("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:l.fontSize}},d.default!==void 0?d.default():[c("div",B.value)])),c("div",{class:`q-circular-progress q-circular-progress--${l.indeterminate===!0?"in":""}determinate`,style:r.value,role:"progressbar","aria-valuemin":l.min,"aria-valuemax":l.max,"aria-valuenow":l.indeterminate===!0?void 0:B.value},Se(d.internal,e))}}});function W(l,d,a,r){const i=[];return l.forEach(_=>{r(_)===!0?i.push(_):d.push({failedPropValidation:a,file:_})}),i}function J(l){l&&l.dataTransfer&&(l.dataTransfer.dropEffect="copy"),fe(l)}const He={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ge=["rejected"];function Je({editable:l,dnd:d,getFileInput:a,addFilesToQueue:r}){const{props:i,emit:_,proxy:h}=ee(),N=k(null),B=F(()=>i.accept!==void 0?i.accept.split(",").map(o=>(o=o.trim(),o==="*"?"*/":(o.endsWith("/*")&&(o=o.slice(0,o.length-1)),o.toUpperCase()))):null),z=F(()=>parseInt(i.maxFiles,10)),C=F(()=>parseInt(i.maxTotalSize,10));function p(o){if(l.value)if(o!==Object(o)&&(o={target:null}),o.target!==null&&o.target.matches('input[type="file"]')===!0)o.clientX===0&&o.clientY===0&&ve(o);else{const U=a();U&&U!==o.target&&U.click(o)}}function u(o){l.value&&o&&r(null,o)}function e(o,U,A,L){let s=Array.from(U||o.target.files);const x=[],E=()=>{x.length>0&&_("rejected",x)};if(i.accept!==void 0&&B.value.indexOf("*/")===-1&&(s=W(s,x,"accept",m=>B.value.some(b=>m.type.toUpperCase().startsWith(b)||m.name.toUpperCase().endsWith(b))),s.length===0))return E();if(i.maxFileSize!==void 0){const m=parseInt(i.maxFileSize,10);if(s=W(s,x,"max-file-size",b=>b.size<=m),s.length===0)return E()}if(i.multiple!==!0&&s.length>0&&(s=[s[0]]),s.forEach(m=>{m.__key=m.webkitRelativePath+m.lastModified+m.name+m.size}),L===!0){const m=A.map(b=>b.__key);s=W(s,x,"duplicate",b=>m.includes(b.__key)===!1)}if(s.length===0)return E();if(i.maxTotalSize!==void 0){let m=L===!0?A.reduce((b,O)=>b+O.size,0):0;if(s=W(s,x,"max-total-size",b=>(m+=b.size,m<=C.value)),s.length===0)return E()}if(typeof i.filter=="function"){const m=i.filter(s);s=W(s,x,"filter",b=>m.includes(b))}if(i.maxFiles!==void 0){let m=L===!0?A.length:0;if(s=W(s,x,"max-files",()=>(m++,m<=z.value)),s.length===0)return E()}if(E(),s.length>0)return s}function n(o){J(o),d.value!==!0&&(d.value=!0)}function y(o){fe(o),(o.relatedTarget!==null||xe.is.safari!==!0?o.relatedTarget!==N.value:document.elementsFromPoint(o.clientX,o.clientY).includes(N.value)===!1)===!0&&(d.value=!1)}function P(o){J(o);const U=o.dataTransfer.files;U.length>0&&r(null,U),d.value=!1}function g(o){if(d.value===!0)return c("div",{ref:N,class:`q-${o}__dnd absolute-full`,onDragenter:J,onDragover:J,onDragleave:y,onDrop:P})}return Object.assign(h,{pickFiles:p,addFiles:u}),{pickFiles:p,addFiles:u,onDragover:n,onDragleave:y,processFiles:e,getDndNode:g,maxFilesNumber:z,maxTotalSizeNumber:C}}function de(l){return(l*100).toFixed(2)+"%"}const Ke={...qe,...He,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},ge=[...Ge,"start","finish","added","removed"];function Ye(l){const d=ee(),{props:a,slots:r,emit:i,proxy:_}=d,{$q:h}=_,N=ke(a,h);function B(t,f,q){if(t.__status=f,f==="idle"){t.__uploaded=0,t.__progress=0,t.__sizeLabel=ie(t.size),t.__progressLabel="0.00%";return}if(f==="failed"){_.$forceUpdate();return}t.__uploaded=f==="uploaded"?t.size:q,t.__progress=f==="uploaded"?1:Math.min(.9999,t.__uploaded/t.size),t.__progressLabel=de(t.__progress),_.$forceUpdate()}const z=F(()=>a.disable!==!0&&a.readonly!==!0),C=k(!1),p=k(null),u=k(null),e={files:k([]),queuedFiles:k([]),uploadedFiles:k([]),uploadedSize:k(0),updateFileStatus:B,isAlive:()=>ze(d)===!1},{pickFiles:n,addFiles:y,onDragover:P,onDragleave:g,processFiles:o,getDndNode:U,maxFilesNumber:A,maxTotalSizeNumber:L}=Je({editable:z,dnd:C,getFileInput:te,addFilesToQueue:oe});Object.assign(e,l({props:a,slots:r,emit:i,helpers:e})),e.isBusy===void 0&&(e.isBusy=k(!1));const s=k(0),x=F(()=>s.value===0?0:e.uploadedSize.value/s.value),E=F(()=>de(x.value)),m=F(()=>ie(s.value)),b=F(()=>z.value===!0&&e.isUploading.value!==!0&&(a.multiple===!0||e.queuedFiles.value.length===0)&&(a.maxFiles===void 0||e.files.value.length<A.value)&&(a.maxTotalSize===void 0||s.value<L.value)),O=F(()=>z.value===!0&&e.isBusy.value!==!0&&e.isUploading.value!==!0&&e.queuedFiles.value.length>0);Ue(we,re);const v=F(()=>"q-uploader column no-wrap"+(N.value===!0?" q-uploader--dark q-dark":"")+(a.bordered===!0?" q-uploader--bordered":"")+(a.square===!0?" q-uploader--square no-border-radius":"")+(a.flat===!0?" q-uploader--flat no-shadow":"")+(a.disable===!0?" disabled q-uploader--disable":"")+(C.value===!0?" q-uploader--dnd":"")),I=F(()=>"q-uploader__header"+(a.color!==void 0?` bg-${a.color}`:"")+(a.textColor!==void 0?` text-${a.textColor}`:""));Ce(e.isUploading,(t,f)=>{f===!1&&t===!0?i("start"):f===!0&&t===!1&&i("finish")});function T(){a.disable===!1&&(e.abort(),e.uploadedSize.value=0,s.value=0,le(),e.files.value=[],e.queuedFiles.value=[],e.uploadedFiles.value=[])}function M(){a.disable===!1&&K(["uploaded"],()=>{e.uploadedFiles.value=[]})}function R(){K(["idle","failed"],({size:t})=>{s.value-=t,e.queuedFiles.value=[]})}function K(t,f){if(a.disable===!0)return;const q={files:[],size:0},j=e.files.value.filter(w=>t.indexOf(w.__status)===-1?!0:(q.size+=w.size,q.files.push(w),w.__img!==void 0&&window.URL.revokeObjectURL(w.__img.src),!1));q.files.length>0&&(e.files.value=j,f(q),i("removed",q.files))}function ae(t){a.disable||(t.__status==="uploaded"?e.uploadedFiles.value=e.uploadedFiles.value.filter(f=>f.__key!==t.__key):t.__status==="uploading"?t.__abort():s.value-=t.size,e.files.value=e.files.value.filter(f=>f.__key!==t.__key?!0:(f.__img!==void 0&&window.URL.revokeObjectURL(f.__img.src),!1)),e.queuedFiles.value=e.queuedFiles.value.filter(f=>f.__key!==t.__key),i("removed",[t]))}function le(){e.files.value.forEach(t=>{t.__img!==void 0&&window.URL.revokeObjectURL(t.__img.src)})}function te(){return u.value||p.value.getElementsByClassName("q-uploader__input")[0]}function oe(t,f){const q=o(t,f,e.files.value,!0),j=te();j!=null&&(j.value=""),q!==void 0&&(q.forEach(w=>{if(e.updateFileStatus(w,"idle"),s.value+=w.size,a.noThumbnails!==!0&&w.type.toUpperCase().startsWith("IMAGE")){const ue=new Image;ue.src=window.URL.createObjectURL(w),w.__img=ue}}),e.files.value=e.files.value.concat(q),e.queuedFiles.value=e.queuedFiles.value.concat(q),i("added",q),a.autoUpload===!0&&e.upload())}function _e(){O.value===!0&&e.upload()}function X(t,f,q){if(t===!0){const j={type:"a",key:f,icon:h.iconSet.uploader[f],flat:!0,dense:!0};let w;return f==="add"?(j.onClick=n,w=re):j.onClick=q,c(Y,j,w)}}function re(){return c("input",{ref:u,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:a.accept,multiple:a.multiple===!0?"multiple":void 0,capture:a.capture,onMousedown:ve,onClick:n,onChange:oe})}function he(){return r.header!==void 0?r.header($):[c("div",{class:"q-uploader__header-content column"},[c("div",{class:"flex flex-center no-wrap q-gutter-xs"},[X(e.queuedFiles.value.length>0,"removeQueue",R),X(e.uploadedFiles.value.length>0,"removeUploaded",M),e.isUploading.value===!0?c(ne,{class:"q-uploader__spinner"}):null,c("div",{class:"col column justify-center"},[a.label!==void 0?c("div",{class:"q-uploader__title"},[a.label]):null,c("div",{class:"q-uploader__subtitle"},[m.value+" / "+E.value])]),X(b.value,"add"),X(a.hideUploadBtn===!1&&O.value===!0,"upload",e.upload),X(e.isUploading.value,"clear",e.abort)])])]}function be(){return r.list!==void 0?r.list($):e.files.value.map(t=>c("div",{key:t.__key,class:"q-uploader__file relative-position"+(a.noThumbnails!==!0&&t.__img!==void 0?" q-uploader__file--img":"")+(t.__status==="failed"?" q-uploader__file--failed":t.__status==="uploaded"?" q-uploader__file--uploaded":""),style:a.noThumbnails!==!0&&t.__img!==void 0?{backgroundImage:'url("'+t.__img.src+'")'}:null},[c("div",{class:"q-uploader__file-header row flex-center no-wrap"},[t.__status==="failed"?c(Re,{class:"q-uploader__file-status",name:h.iconSet.type.negative,color:"negative"}):null,c("div",{class:"q-uploader__file-header-content col"},[c("div",{class:"q-uploader__title"},[t.name]),c("div",{class:"q-uploader__subtitle row items-center no-wrap"},[t.__sizeLabel+" / "+t.__progressLabel])]),t.__status==="uploading"?c(Xe,{value:t.__progress,min:0,max:1,indeterminate:t.__progress===0}):c(Y,{round:!0,dense:!0,flat:!0,icon:h.iconSet.uploader[t.__status==="uploaded"?"done":"clear"],onClick:()=>{ae(t)}})])]))}Be(()=>{e.isUploading.value===!0&&e.abort(),e.files.value.length>0&&le()});const $={};for(const t in e)Pe(e[t])===!0?Ee($,t,()=>e[t].value):$[t]=e[t];return Object.assign($,{upload:_e,reset:T,removeUploadedFiles:M,removeQueuedFiles:R,removeFile:ae,pickFiles:n,addFiles:y}),Ne($,{canAddFiles:()=>b.value,canUpload:()=>O.value,uploadSizeLabel:()=>m.value,uploadProgressLabel:()=>E.value}),Object.assign(_,$),()=>{const t=[c("div",{class:I.value},he()),c("div",{class:"q-uploader__list scroll"},be()),U("uploader")];e.isBusy.value===!0&&t.push(c("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[c(ne)]));const f={ref:p,class:v.value};return b.value===!0&&Object.assign(f,{onDragover:P,onDragleave:g}),c("div",f,t)}}const Ze=()=>!0;function ea(l){const d={};return l.forEach(a=>{d[a]=Ze}),d}const aa=ea(ge);var la=({name:l,props:d,emits:a,injectPlugin:r})=>ce({name:l,props:{...Ke,...d},emits:je(a)===!0?{...aa,...a}:[...ge,...a],setup(){return Ye(r)}});function V(l){return typeof l=="function"?l:()=>l}const ta={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>l=>l.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},oa=["factory-failed","uploaded","failed","uploading"];function ra({props:l,emit:d,helpers:a}){const r=k([]),i=k([]),_=k(0),h=F(()=>({url:V(l.url),method:V(l.method),headers:V(l.headers),formFields:V(l.formFields),fieldName:V(l.fieldName),withCredentials:V(l.withCredentials),sendRaw:V(l.sendRaw),batch:V(l.batch)})),N=F(()=>_.value>0),B=F(()=>i.value.length>0);let z;function C(){r.value.forEach(n=>{n.abort()}),i.value.length>0&&(z=!0)}function p(){const n=a.queuedFiles.value.slice(0);a.queuedFiles.value=[],h.value.batch(n)?u(n):n.forEach(y=>{u([y])})}function u(n){if(_.value++,typeof l.factory!="function"){e(n,{});return}const y=l.factory(n);if(!y)d("factory-failed",new Error("QUploader: factory() does not return properly"),n),_.value--;else if(typeof y.catch=="function"&&typeof y.then=="function"){i.value.push(y);const P=g=>{a.isAlive()===!0&&(i.value=i.value.filter(o=>o!==y),i.value.length===0&&(z=!1),a.queuedFiles.value=a.queuedFiles.value.concat(n),n.forEach(o=>{a.updateFileStatus(o,"failed")}),d("factoryFailed",g,n),_.value--)};y.then(g=>{z===!0?P(new Error("Aborted")):a.isAlive()===!0&&(i.value=i.value.filter(o=>o!==y),e(n,g))}).catch(P)}else e(n,y||{})}function e(n,y){const P=new FormData,g=new XMLHttpRequest,o=(v,I)=>y[v]!==void 0?V(y[v])(I):h.value[v](I),U=o("url",n);if(!U){console.error("q-uploader: invalid or no URL specified"),_.value--;return}const A=o("formFields",n);A!==void 0&&A.forEach(v=>{P.append(v.name,v.value)});let L=0,s=0,x=0,E=0,m;g.upload.addEventListener("progress",v=>{if(m===!0)return;const I=Math.min(E,v.loaded);a.uploadedSize.value+=I-x,x=I;let T=x-s;for(let M=L;T>0&&M<n.length;M++){const R=n[M];if(T>R.size)T-=R.size,L++,s+=R.size,a.updateFileStatus(R,"uploading",R.size);else{a.updateFileStatus(R,"uploading",T);return}}},!1),g.onreadystatechange=()=>{g.readyState<4||(g.status&&g.status<400?(a.uploadedFiles.value=a.uploadedFiles.value.concat(n),n.forEach(v=>{a.updateFileStatus(v,"uploaded")}),d("uploaded",{files:n,xhr:g})):(m=!0,a.uploadedSize.value-=x,a.queuedFiles.value=a.queuedFiles.value.concat(n),n.forEach(v=>{a.updateFileStatus(v,"failed")}),d("failed",{files:n,xhr:g})),_.value--,r.value=r.value.filter(v=>v!==g))},g.open(o("method",n),U),o("withCredentials",n)===!0&&(g.withCredentials=!0);const b=o("headers",n);b!==void 0&&b.forEach(v=>{g.setRequestHeader(v.name,v.value)});const O=o("sendRaw",n);n.forEach(v=>{a.updateFileStatus(v,"uploading",0),O!==!0&&P.append(o("fieldName",v),v,v.name),v.xhr=g,v.__abort=()=>{g.abort()},E+=v.size}),d("uploading",{files:n,xhr:g}),r.value.push(g),O===!0?g.send(new Blob(n)):g.send(P)}return{isUploading:N,isBusy:B,abort:C,upload:p}}var ua={name:"QUploader",props:ta,emits:oa,injectPlugin:ra},na=la(ua);const sa={class:"row q-col-gutter-sm q-ma-xs"},ia={class:"col-lg-6 col-md-6 col-sm-12 col-xs-12"},da={class:"col-lg-6 col-md-6 col-sm-12 col-xs-12"},ha={__name:"PerfilPage",setup(l){Ve(()=>{r.value.first_name=a.user.firstname,r.value.last_name=a.user.lastname,r.value.age=a.user.age,r.value.email=a.user.email,r.value.gender=a.user.gender,r.value.occupation=a.user.occupation,r.value.school=a.user.school});const d=k(null),a=Ae(),r=k({first_name:"",last_name:"",age:0,email:"",gender:"",occupation:"",school:""});function i(){d.value.validate().then(p=>{p&&Te.editUser(r).then(u=>{console.log("\u{1F680} ~ userService.editUser ~ res:",u)})})}function _(p){return p&&p.length>0||"El campo es requerido"}function h(p){console.log("Archivo agregado:",p)}function N(p){console.log("\u{1F680} ~ onProgress ~ file:",p)}function B(p,u){console.log("\u{1F680} ~ onComplete ~ response:",u),console.log("Carga completada:",p)}function z(p,u){console.error(" factoryfailed:",u)}function C(p,u){return console.log("\u{1F680} ~ uploadFile ~ formData:",u),console.log("\u{1F680} ~ uploadFile ~ file:",p),new Promise(e=>{e({url:`http://127.0.0.1:3210/api/user/img/${a.user.uuid}`,method:"POST"})})}return(p,u)=>(Le(),Oe(De,null,{default:Q(()=>[H("div",sa,[H("div",ia,[S(se,null,{default:Q(()=>[S(G,null,{default:Q(()=>[S(Qe,{ref_key:"myForm",ref:d,class:"q-gutter-md",onSubmit:i},{default:Q(()=>[S(D,{filled:"",modelValue:r.value.first_name,"onUpdate:modelValue":u[0]||(u[0]=e=>r.value.first_name=e),label:"Nombre",rules:[_]},null,8,["modelValue","rules"]),S(D,{filled:"",modelValue:r.value.last_name,"onUpdate:modelValue":u[1]||(u[1]=e=>r.value.last_name=e),label:"Apellidos",rules:[_]},null,8,["modelValue","rules"]),S(D,{filled:"",modelValue:r.value.email,"onUpdate:modelValue":u[2]||(u[2]=e=>r.value.email=e),label:"Correo",rules:[_]},null,8,["modelValue","rules"]),S(D,{filled:"",modelValue:r.value.age,"onUpdate:modelValue":u[3]||(u[3]=e=>r.value.age=e),label:"Edad",type:"number"},null,8,["modelValue"]),S(D,{filled:"",modelValue:r.value.gender,"onUpdate:modelValue":u[4]||(u[4]=e=>r.value.gender=e),label:"Genero"},null,8,["modelValue"]),S(D,{filled:"",modelValue:r.value.school,"onUpdate:modelValue":u[5]||(u[5]=e=>r.value.school=e),label:"Estudios"},null,8,["modelValue"]),S(D,{filled:"",modelValue:r.value.occupation,"onUpdate:modelValue":u[6]||(u[6]=e=>r.value.occupation=e),label:"Ocupaci\xF3n"},null,8,["modelValue"]),H("div",null,[S(Y,{label:"Actualizar",type:"submit",color:"primary"})])]),_:1},512)]),_:1})]),_:1})]),H("div",da,[S(se,{class:"my-card",flat:"",bordered:""},{default:Q(()=>[S(G,{vertical:"",class:"flex column flex-center"},{default:Q(()=>[S(G,{class:"col-5 flex flex-center"},{default:Q(()=>[S(Ie,{class:"rounded-borders",style:{width:"150px"},src:"https://cdn.quasar.dev/img/boy-avatar.png"})]),_:1}),S(G,null,{default:Q(()=>[S(na,{ref:"pic",label:"Actualizar foto perfil",onAdded:h,onUploading:N,onFinish:B,onFactoryFailed:z,url:"",accept:"jpg ","max-file-size":50*1024*1024,style:{"max-width":"250px"},factory:C},null,512)]),_:1})]),_:1})]),_:1})])])]),_:1}))}};export{ha as default};
